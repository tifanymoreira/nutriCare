<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agendamento de Consulta - NutriCare</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../../css/style.css">
</head>

<body class="bg-light">
    <div class="container py-5">
        <header class="text-center mb-5">
            <a class="navbar-brand" href="/">
                <i class="bi bi-heart-pulse-fill"></i> NutriCare
            </a>
            <h1 class="section-title mt-4">Solicitação de Consulta</h1>
            <p class="lead text-muted">Solicite seu horário com <strong id="nutriName">Dra. Nutricionista</strong>.</p>
            <div id="loading-message" class="mt-3" style="display: none;">
                <span class="text-primary"><i class="bi bi-arrow-clockwise spinner-border spinner-border-sm me-2"></i> Carregando dados da Nutri...</span>
            </div>
        </header>

        <div class="row justify-content-center">
            <div class="col-lg-10 col-xl-8">
                <div class="card data-card shadow-sm">
                    <div class="card-body p-4 p-md-5">
                        <div id="booking-flow">
                            
                            <div class="booking-step active" id="step1">
                                <h4 class="step-title">1. Escolha o serviço</h4>
                                <div class="service-list">
                                    <div class="service-item" data-service-id="1" data-duration="60">
                                        <div class="service-icon"><i class="bi bi-person-check-fill"></i></div>
                                        <div class="service-details">
                                            <h5>Primeira Consulta</h5>
                                            <p>Avaliação completa e plano alimentar inicial.</p>
                                        </div>
                                        <div class="service-meta">
                                            <span>60 min</span>
                                            <strong>R$ 350,00</strong>
                                        </div>
                                    </div>
                                    <div class="service-item" data-service-id="2" data-duration="45">
                                        <div class="service-icon"><i class="bi bi-arrow-repeat"></i></div>
                                        <div class="service-details">
                                            <h5>Consulta de Retorno</h5>
                                            <p>Acompanhamento da evolução e ajustes no plano.</p>
                                        </div>
                                        <div class="service-meta">
                                            <span>45 min</span>
                                            <strong>R$ 250,00</strong>
                                        </div>
                                    </div>
                                    <div class="service-item" data-service-id="3" data-duration="50">
                                        <div class="service-icon"><i class="bi bi-camera-video-fill"></i></div>
                                        <div class="service-details">
                                            <h5>Consulta Online</h5>
                                            <p>Atendimento completo por videochamada.</p>
                                        </div>
                                        <div class="service-meta">
                                            <span>50 min</span>
                                            <strong>R$ 300,00</strong>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="booking-step" id="step2">
                                <h4 class="step-title">2. Selecione a data e o horário</h4>
                                <div id="agenda-alert-message" class="alert alert-warning" style="display: none;"></div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div id="datepicker" class="mb-4"></div>
                                    </div>
                                    <div class="col-md-6">
                                        <div id="time-slots-container">
                                            <h6 class="text-center" id="selectedDate">Escolha uma data no calendário</h6>
                                            <div class="time-slots-list">
                                                </div>
                                            <div id="slots-loader" class="text-center mt-3" style="display: none;">
                                                <span class="spinner-border spinner-border-sm text-primary"></span> Carregando horários...
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button class="btn btn-outline-secondary mt-3" id="backToStep1"><i class="bi bi-arrow-left"></i> Voltar</button>
                            </div>

                            <div class="booking-step" id="step3">
                                <h4 class="step-title">3. Confirme seus dados</h4>
                                <div class="booking-summary">
                                    <h5>Resumo da Solicitação</h5>
                                    <p><i class="bi bi-card-checklist"></i> <strong>Serviço:</strong> <span id="summaryService"></span></p>
                                    <p><i class="bi bi-calendar-check"></i> <strong>Data e Hora:</strong> <span id="summaryDateTime"></span></p>
                                    <p><i class="bi bi-cash-coin"></i> <strong>Valor:</strong> <span id="summaryPrice"></span></p>
                                </div>
                                <form id="bookingForm">
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="fullName" class="form-label">Nome Completo</label>
                                            <input type="text" class="form-control" id="fullName" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="email" class="form-label">E-mail</label>
                                            <input type="email" class="form-control" id="email" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="phone" class="form-label">Telefone (WhatsApp)</label>
                                            <input type="tel" class="form-control" id="phone" required>
                                        </div>
                                    </div>
                                    <div class="form-check mb-3">
                                        <input class="form-check-input" type="checkbox" value="" id="confirmTerms" required>
                                        <label class="form-check-label" for="confirmTerms">
                                            Estou ciente e concordo com a <a href="#">política de cancelamento</a>.
                                        </label>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <button type="button" class="btn btn-outline-secondary" id="backToStep2"><i class="bi bi-arrow-left"></i> Voltar</button>
                                        <button type="submit" class="btn btn-primary-custom" id="confirmBookingBtn">Solicitar Agendamento</button>
                                    </div>
                                </form>
                            </div>

                            <div class="booking-step" id="step4">
                                <div class="text-center py-4">
                                    <div class="success-icon mx-auto mb-4" style="background-color: var(--secondary-orange);">
                                        <i class="bi bi-hourglass-split"></i>
                                    </div>
                                    <h2 class="h4 fw-bold" id="successTitle">Solicitação Enviada!</h2>
                                    <p class="text-muted" id="successMessage">Seu pré-agendamento foi enviado com sucesso! Aguarde a aprovação do seu nutricionista, que pode levar até 24h.</p>
                                    <p class="mt-4" id="nextStepMessage">O próximo passo é preencher o questionário pré-consulta para criar sua conta.</p>
                                    <a href="#" id="anamneseLink" class="btn btn-primary-custom mt-2">
                                        <i class="bi bi-file-text-fill me-2"></i>Ir para o Questionário
                                    </a>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/vanillajs-datepicker@1.3.4/dist/js/datepicker-full.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vanillajs-datepicker@1.3.4/dist/css/datepicker-bs5.min.css">

    <script type="module" src="../../js/preSchedule.js"></script>
</body>

</html>