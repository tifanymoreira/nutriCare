<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Dashboard - NutriCare</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="../../css/style.css">
</head>

<body>
    <div class="dashboard-wrapper">
        <aside class="dashboard-sidebar">
            <div class="sidebar-header">
                <a class="navbar-brand" href="#"><i class="bi bi-heart-pulse-fill"></i> NutriCare</a>
            </div>
            <nav class="sidebar-nav">
                <ul class="list-unstyled">
                    <li class="nav-item active"><a href="dashboard.html" class="nav-link"><i
                                class="bi bi-grid-1x2-fill"></i> Início</a></li>
                    <li class="nav-item"><a href="planoAlimentar.html" class="nav-link"><i
                                class="bi bi-file-earmark-text-fill"></i> Plano Alimentar</a></li>
                    <li class="nav-item"><a href="agenda.html" class="nav-link"><i
                                class="bi bi-calendar2-week-fill"></i> Minha Agenda</a></li>
                    <li class="nav-item"><a href="encaminhamentos.html" class="nav-link"><i
                                class="bi bi-folder-symlink-fill"></i> Encaminhamentos</a></li>
                    <li class="nav-item"><a href="receituario.html" class="nav-link"><i class="bi bi-capsule-pill"></i>
                            Receituário</a></li>
                    <li class="nav-item"><a href="pagamentos.html" class="nav-link"><i class="bi bi-wallet-fill"></i>
                            Pagamentos</a></li>
                    <li class="nav-item"><a href="configuracoes.html" class="nav-link"><i
                                class="bi bi-person-fill-gear"></i> Configurações</a></li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <button id="logoutBtn" class="btn btn-logout w-100"><i class="bi bi-box-arrow-left"></i> Sair</button>
            </div>
        </aside>

        <main class="dashboard-main">
            <header class="dashboard-content-header">
                <div class="welcome-message">
                    <h1 class="mb-0">Bem-vindo(a), <span id="userName">...</span>!</h1>
                    <p class="text-muted">Este é o seu resumo de saúde e bem-estar.</p>
                </div>

                <div class="notification-icon-container">
                    <button class="notification-icon" id="notificationBell">
                        <i class="bi bi-bell-fill"></i>
                        <span class="notification-badge" id="notificationCount" style="display: none;">0</span>
                    </button>
                    <div class="notification-dropdown" id="notificationDropdown">
                        <h6 class="dropdown-header">Suas Notificações</h6>
                        <div class="dropdown-body" id="notificationList">
                            <p class="text-center text-muted small mt-3" id="noNotificationsMessage">Tudo em dia! ✨</p>
                        </div>
                    </div>
                </div>
            </header>

            <div class="row g-4">

                <div class="col-lg-12">
                    <div id="nextAppointmentCard" class="card data-card next-appointment-card" style="display: none;">
                        <div class="card-body d-flex align-items-center justify-content-between p-4">
                            <div class="appointment-details-highlight d-flex align-items-center">
                                <i class="bi bi-calendar-check-fill me-4 display-6 text-primary-custom"></i>
                                <div>
                                    <h5 class="card-title fw-bold text-dark-charcoal mb-1">Próxima Consulta Confirmada
                                    </h5>
                                    <p class="mb-0">
                                        <span id="nextAppointmentService"></span> em
                                        <strong id="nextAppointmentDate" class="text-secondary-orange"></strong> às
                                        <strong id="nextAppointmentTime" class="text-secondary-orange"></strong>
                                    </p>
                                </div>
                            </div>
                            <button id="viewDetailsBtn" class="btn btn-primary-custom btn-sm">Ver Detalhes</button>
                        </div>
                    </div>
                    <div id="emptyNextAppointmentCard" class="card data-card" style="display: none;">
                        <div class="card-body text-center p-4">
                            <i class="bi bi-calendar-heart me-2 display-6 text-primary-custom"></i>
                            <h5 class="card-title fw-bold text-dark-charcoal mb-1 mt-2">Sua agenda está livre! ✨</h5>
                            <p class="text-muted mb-0">Aproveite o seu dia com tranquilidade. Estamos aqui quando
                                precisar.</p>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4 col-md-6">
                    <div class="stat-card">
                        <div class="stat-icon icon-patients"><i class="bi bi-person-arms-up"></i></div>
                        <div class="stat-info">
                            <span class="stat-number" id="currentWeight">-- kg</span>
                            <span class="stat-label">Peso Atual</span>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6">
                    <div class="stat-card">
                        <div class="stat-icon icon-rating"><i class="bi bi-rulers"></i></div>
                        <div class="stat-info">
                            <span class="stat-number" id="currentBmi">--</span>
                            <span class="stat-label">IMC Atual</span>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6">
                    <div class="stat-card">
                        <div class="stat-icon icon-appointments"><i class="bi bi-graph-up-arrow"></i></div>
                        <div class="stat-info">
                            <span class="stat-number" id="weightDifference">-- kg</span>
                            <span class="stat-label">Evolução desde o Início</span>
                        </div>
                    </div>
                </div>

                <div class="col-12">
                    <div class="card data-card">
                        <div class="card-header">
                            <ul class="nav nav-tabs card-header-tabs" id="evolutionTabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="weight-tab" data-bs-toggle="tab"
                                        data-bs-target="#weight-pane" type="button" role="tab">Evolução de Peso</button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="fat-tab" data-bs-toggle="tab"
                                        data-bs-target="#fat-pane" type="button" role="tab">Gordura Corporal
                                        (%)</button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="measures-tab" data-bs-toggle="tab"
                                        data-bs-target="#measures-pane" type="button" role="tab">Circunferências
                                        (cm)</button>
                                </li>
                            </ul>
                        </div>
                        <div class="card-body">
                            <div class="tab-content" id="evolutionTabsContent">
                                <div class="tab-pane fade show active" id="weight-pane" role="tabpanel">
                                    <canvas id="weightChart" style="max-height: 300px;"></canvas>
                                </div>
                                <div class="tab-pane fade" id="fat-pane" role="tabpanel">
                                    <canvas id="fatChart" style="max-height: 300px;"></canvas>
                                </div>
                                <div class="tab-pane fade" id="measures-pane" role="tabpanel">
                                    <canvas id="measuresChart" style="max-height: 300px;"></canvas>
                                </div>
                            </div>
                            <div id="emptyChartState" class="text-center p-4" style="display: none;">
                                <i class="bi bi-bar-chart-fill text-muted display-6"></i>
                                <p class="text-muted mt-2">Faltam dados para gerar os gráficos. Eles aparecerão após seu
                                    primeiro retorno!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div id="whatsapp-widget" class="whatsapp-widget">
        <i class="bi bi-whatsapp"></i>
    </div>

    <div class="modal-backdrop" id="contactNutriModal">
        <div class="modal-content text-center">
            <button class="modal-close" id="closeContactModal">&times;</button>
            <h4 class="card-title">Fale com sua Nutri</h4>
            <p class="text-muted mb-3">Dra. <strong id="nutriName"></strong></p>
            <button class="btn-modal-wpp" id="sendText"><i class="bi bi-whatsapp"></i> Enviar Mensagem</button>
        </div>
    </div>

    <div class="modal-backdrop" id="appointmentDetailsModal">
        <div class="modal-content pro-modal">
            <button class="modal-close" id="closeDetailsModal">&times;</button>
            <div class="modal-icon"><i class="bi bi-calendar-event"></i></div>
            <h4 class="modal-title-pro" id="modalServiceType">Detalhes da Consulta</h4>
            <p class="modal-subtitle-pro">Informações completas do seu próximo compromisso.</p>

            <div class="text-start mb-4 p-3 bg-light rounded">
                <p class="mb-2"><strong><i class="bi bi-clock-fill me-2"></i> Data e Hora:</strong> <span
                        id="modalDateTime" class="text-dark-charcoal"></span></p>
                <p class="mb-2"><strong><i class="bi bi-stopwatch-fill me-2"></i> Duração:</strong> <span
                        id="modalDuration" class="text-dark-charcoal"></span></p>
                <p class="mb-0"><strong><i class="bi bi-person-badge-fill me-2"></i> Nutricionista:</strong> <span
                        id="modalNutriName" class="text-dark-charcoal"></span></p>
            </div>

            <div class="text-start mb-4 p-3 bg-light rounded">
                <p class="mb-2"><strong><i class="bi bi-whatsapp me-2"></i> Contato da Nutri:</strong> <span
                        id="modalNutriPhone" class="text-dark-charcoal"></span></p>
                <a id="modalWppLink" class="btn-wpp-large w-100" target="_blank" style="display: none;">
                    <i class="bi bi-whatsapp me-2"></i> Enviar Mensagem
                </a>
            </div>

            <div class="d-flex justify-content-center gap-3">
                <button id="modalCancelBtn" class="btn btn-outline-secondary w-100"><i class="bi bi-x-circle me-1"></i>
                    Cancelar</button>
                <button id="modalRescheduleBtn" class="btn btn-primary-custom w-100"><i
                        class="bi bi-arrow-repeat me-1"></i> Reagendar</button>
            </div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module" src="../../js/dashboard-paciente.js"></script>
</body>

</html>